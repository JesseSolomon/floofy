'use strict';function floofy(b,l){const c={};let d,g;d=floofy.element_register in b?b[floofy.element_register]:b[floofy.element_register]={};floofy.mutation_observer in b?g=b[floofy.mutation_observer]:(g=new MutationObserver(a=>{for(let k of a)g[floofy.mutation_update](Array.from(k.addedNodes).filter(h=>h instanceof HTMLElement))}),g.observe(b,{childList:!0,subtree:!0}),g[floofy.mutation_update]=a=>{let k=[];a:for(let h of a){for(let e in d)if(!(d[e].signature in h)&&h.matches(e)){h[d[e].signature]=
!0;d[e].constructor(h);k.push(!0);continue a}k.push(!1)}return k},b[floofy.mutation_observer]=g);const f=(a,k,h)=>{k=k.split(" ").map(n=>n.trim()).filter(n=>0<n.length);for(let n of k){if(k.indexOf(n)<k.length-1||h)if(a instanceof Element||a instanceof Document){var e=a.querySelector(n);if(e){a=e;continue}}e=n+"";let m;e=e.replace(/^[\w-_]+/,p=>{m=document.createElement(p);return""});m||(m=document.createElement("div"));e=e.replace(/\[[\w\-_]*(\s*=\s*)?([\w\-_]+|"((?!").)*"|'((?!').*)')\]/g,p=>{let [r,
q]=p.replace(/(^\[|\]$)/g,"").split("=").map(t=>t.trim());q&&(q=q.replace(/(^"|"$)/g,"").replace(/(^'|'$)/g,""));m.setAttribute(r,q||"");return""});e=e.replace(/#[\w-_]+/g,p=>{m.id=p.substr(1);return""});e=e.replace(/\.[\w-_]+/g,p=>{m.classList.add(p.substr(1));return""});a.appendChild(m);a=m}if(a instanceof HTMLElement){h=a;do if(h=h.parentElement||document,floofy.mutation_observer in h&&floofy.mutation_update in h[floofy.mutation_observer]&&h[floofy.mutation_observer][floofy.mutation_update]([a])[0])break;
while(!h.isSameNode(document))}return a instanceof HTMLElement?a:void 0};Object.defineProperty(c,"for",{get:()=>()=>{},set:a=>{if("function"===typeof a){if(l in d)throw`Floofy Exception: cannot reassign "for" handler on selector "${l}"`;d[l]={signature:Symbol(l),constructor:a};for(let k of c.all)a(k)}else throw`Floofy Exception: "for" constructor must by of type function, got ${typeof a}`;}});Object.defineProperty(c,"actual",{get:()=>f(b,l,!0)});Object.defineProperty(c,"new",{get:()=>f(b,l,!1)});
if(b instanceof Element||b instanceof Document)Object.defineProperty(c,"all",{get:()=>Array.from(b.querySelectorAll(l)).filter(a=>a instanceof HTMLElement)}),Object.defineProperty(c,"first",{get:()=>b.querySelector(l)});return c}
(function(b){b.element_register=Symbol("element_register");b.mutation_observer=Symbol("mutation_observer");b.mutation_update=Symbol("mutation_update");b.page_register={};Object.defineProperty(String.prototype,"f",{get(){return b(document,this)}});Object.defineProperty(Node.prototype,"f",{get(){return new Proxy({},{get:(l,c)=>{if("string"===typeof c)return b(this,c);throw`Floofy Exception: selectors must be of type string, got ${typeof c}`;}})}});Object.defineProperty(Location.prototype,"f",{get:()=>
new Proxy({},{set:(l,c,d)=>{if("function"===typeof d){if("string"===typeof c){l=c.split("/").filter(f=>0<f.length);let g={capture_groups:[],handler:d};d="^\\/"+l.map(f=>"*"===f?"(?:[\\w\\.\\-%~:?#\\[\\]@!$&'\\(\\)*+,;]+)":f.startsWith("$")?(g.capture_groups.push(f),"([\\w\\.\\-%~:?#\\[\\]@!$&'\\(\\)*+,;]+)"):f).join("\\/")+"\\/?$";if(d in b.page_register)throw`Floofy Exception: location handler already exists on selector "${c}"`;b.page_register[d]=g;return!0}throw`Floofy Exception: location selector must be of type string, got ${typeof c}`;
}throw`Floofy Exception: location handler must be of type function, got ${typeof d}`;},get:(l,c)=>{if("string"===typeof c){for(let d in b.page_register){let g=c.match(new RegExp(d));if(g)return(f,a)=>{if(f&&"object"!==typeof f)throw`Floofy Exception: location state must be of type object, got ${typeof f}`;{let k={};for(let e=0;e<b.page_register[d].capture_groups.length;e++)k[b.page_register[d].capture_groups[e]]=decodeURIComponent(g[e+1]);let h;f={...null!=(h=history.state)?h:{},...null!=f?f:{},...k};
location.pathname!==c&&history.pushState(f,null!=a?a:document.title,c);a&&document.title!==a&&(document.title=a);b.page_register[d].handler(f)}}}return(d,g)=>{let f;d={...null!=(f=history.state)?f:{},...null!=d?d:{}};location.pathname!==c&&history.pushState(d,null!=g?g:document.title,c);g&&document.title!==g&&(document.title=g)}}throw`Floofy Exception: URL selector must be of type string, got ${typeof c}`;}})});addEventListener("DOMContentLoaded",()=>{location.f[location.pathname]();addEventListener("popstate",
()=>{location.f[location.pathname]()})})})(floofy||(floofy={}));
