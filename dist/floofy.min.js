'use strict';function floofy(a,g){const b={};let e,l;e=floofy.element_register in a?a[floofy.element_register]:a[floofy.element_register]={};floofy.mutation_observer in a?l=a[floofy.mutation_observer]:(l=new MutationObserver(c=>{for(let h of c)l[floofy.mutation_update](Array.from(h.addedNodes).filter(d=>d instanceof HTMLElement))}),l.observe(a,{childList:!0,subtree:!0}),l[floofy.mutation_update]=c=>{let h=[];a:for(let d of c){for(let k in e)if(!(e[k].signature in d)&&d.matches(k)){d[e[k].signature]=
!0;e[k].constructor(d);h.push(!0);continue a}h.push(!1)}return h},a[floofy.mutation_observer]=l);const f=(c,h,d)=>{h=h.split(" ").map(n=>n.trim()).filter(n=>0<n.length);for(let n of h){if(h.indexOf(n)<h.length-1||d)if(c instanceof Element||c instanceof Document){var k=c.querySelector(n);if(k){c=k;continue}}k=n+"";let m;k=k.replace(/^[\w-_]+/,p=>{m=document.createElement(p);return""});m||(m=document.createElement("div"));k=k.replace(/\[[\w\-_]*(\s*=\s*)?([\w\-_]+|"((?!").)*"|'((?!').*)')\]/g,p=>{let [r,
q]=p.replace(/(^\[|\]$)/g,"").split("=").map(t=>t.trim());q&&(q=q.replace(/(^"|"$)/g,"").replace(/(^'|'$)/g,""));m.setAttribute(r,q||"");return""});k=k.replace(/#[\w-_]+/g,p=>{m.id=p.substr(1);return""});k=k.replace(/\.[\w-_]+/g,p=>{m.classList.add(p.substr(1));return""});c.appendChild(m);c=m}if(c instanceof HTMLElement){d=c;do if(d=d.parentElement||document,floofy.mutation_observer in d&&floofy.mutation_update in d[floofy.mutation_observer]&&(console.log("mutate"),d[floofy.mutation_observer][floofy.mutation_update]([c])[0]))break;
while(!d.isSameNode(document))}return c instanceof HTMLElement?c:void 0};Object.defineProperty(b,"for",{get:()=>()=>{},set:c=>{if("function"===typeof c){if(g in e)throw`Floofy Exception: cannot reassign "for" handler on selector "${g}"`;e[g]={signature:Symbol(g),constructor:c};for(let h of b.all)c(h)}else throw`Floofy Exception: "for" constructor must by of type function, got ${typeof c}`;}});Object.defineProperty(b,"actual",{get:()=>f(a,g,!0)});Object.defineProperty(b,"new",{get:()=>f(a,g,!1)});
if(a instanceof Element||a instanceof Document)Object.defineProperty(b,"all",{get:()=>Array.from(a.querySelectorAll(g)).filter(c=>c instanceof HTMLElement)}),Object.defineProperty(b,"first",{get:()=>a.querySelector(g)});return b}
(function(a){a.element_register=Symbol("element_register");a.mutation_observer=Symbol("mutation_observer");a.mutation_update=Symbol("mutation_update");a.page_register={};Object.defineProperty(String.prototype,"f",{get(){return a(document,this)}});Object.defineProperty(Node.prototype,"f",{get(){return new Proxy({},{get:(g,b)=>{if("string"===typeof b)return a(this,b);throw`Floofy Exception: selectors must be of type string, got ${typeof b}`;}})}});Object.defineProperty(Location.prototype,"f",{get:()=>
new Proxy({},{set:(g,b,e)=>{if("function"===typeof e){if("string"===typeof b){g=b.split("/").filter(f=>0<f.length);let l={capture_groups:[],handler:e};e="^\\/"+g.map(f=>"*"===f?"(?:[\\w\\.\\-%~:/?#\\[\\]@!$&'\\(\\)*+,;]+)":f.startsWith("$")?(l.capture_groups.push(f),"([\\w\\.\\-%~:/?#\\[\\]@!$&'\\(\\)*+,;]+)"):f).join("\\/")+"\\/?$";if(e in a.page_register)throw`Floofy Exception: location handler already exists on selector "${b}"`;a.page_register[e]=l;return!0}throw`Floofy Exception: location selector must be of type string, got ${typeof b}`;
}throw`Floofy Exception: location handler must be of type function, got ${typeof e}`;},get:(g,b)=>{if("string"===typeof b){for(let e in a.page_register){let l=b.match(new RegExp(e));if(l)return f=>{if(f&&"object"!==typeof f)throw`Floofy Exception: location state must be of type object, got ${typeof f}`;{let c={};for(let d=0;d<a.page_register[e].capture_groups.length;d++)c[a.page_register[e].capture_groups[d]]=decodeURIComponent(l[d+1]);let h;f={...null!=(h=history.state)?h:{},...null!=f?f:{},...c};
location.pathname!==b&&history.pushState(f,document.title,b);a.page_register[e].handler(f)}}}return null}throw`Floofy Exception: URL selector must be of type string, got ${typeof b}`;}})});addEventListener("DOMContentLoaded",()=>{let g=location.f[location.pathname];g&&g({});addEventListener("popstate",()=>{let b=location.f[location.pathname];b&&b({})})})})(floofy||(floofy={}));
