'use strict';function floofy(a,f){const b={};let d,l;d=floofy.element_register in a?a[floofy.element_register]:a[floofy.element_register]={};floofy.mutation_observer in a?l=a[floofy.mutation_observer]:(l=new MutationObserver(c=>{for(let h of c)for(let k of Array.from(h.addedNodes))if(k instanceof HTMLElement)for(let g in d)d[g].signature in k||!k.matches(g)||(k[d[g].signature]=!0,d[g].constructor(k))}),l.observe(a,{childList:!0,subtree:!0}),a[floofy.mutation_observer]=l);const e=(c,h,k)=>{h=h.split(" ").map(n=>
n.trim()).filter(n=>0<n.length);for(let n of h){if(h.indexOf(n)<h.length-1||k)if(c instanceof Element||c instanceof Document){var g=c.querySelector(n);if(g){c=g;continue}}g=n+"";let m;g=g.replace(/^[\w-_]+/,p=>{m=document.createElement(p);return""});m||(m=document.createElement("div"));g=g.replace(/\[[\w\-_]*(\s*=\s*)?([\w\-_]+|"((?!").)*"|'((?!').*)')\]/g,p=>{let [r,q]=p.replace(/(^\[|\]$)/g,"").split("=").map(t=>t.trim());q&&(q=q.replace(/(^"|"$)/g,"").replace(/(^'|'$)/g,""));m.setAttribute(r,q||
"");return""});g=g.replace(/(?<=#)[\w-_]+/g,p=>{m.id=p;return""});g=g.replace(/(?<=.)[\w-_]+/g,p=>{m.classList.add(p);return""});c.appendChild(m);c=m}return c instanceof HTMLElement?c:void 0};Object.defineProperty(b,"for",{get:()=>()=>{},set:c=>{if("function"===typeof c){if(f in d)throw`Floofy Exception: cannot reassign "for" handler on selector "${f}"`;d[f]={signature:Symbol(f),constructor:c};for(let h of b.all)c(h)}else throw`Floofy Exception: "for" constructor must by of type function, got ${typeof c}`;
}});Object.defineProperty(b,"actual",{get:()=>e(a,f,!0)});Object.defineProperty(b,"new",{get:()=>e(a,f,!1)});if(a instanceof Element||a instanceof Document)Object.defineProperty(b,"all",{get:()=>Array.from(a.querySelectorAll(f)).filter(c=>c instanceof HTMLElement)}),Object.defineProperty(b,"first",{get:()=>a.querySelector(f)});return b}
(function(a){a.element_register=Symbol("element_register");a.mutation_observer=Symbol("mutation_observer");a.page_register={};Object.defineProperty(String.prototype,"f",{get(){return a(document,this)}});Object.defineProperty(Node.prototype,"f",{get(){return new Proxy({},{get:(f,b)=>{if("string"===typeof b)return a(this,b);throw`Floofy Exception: selectors must be of type string, got ${typeof b}`;}})}});Object.defineProperty(Location.prototype,"f",{get:()=>new Proxy({},{set:(f,b,d)=>{if("function"===
typeof d){if("string"===typeof b){f=b.split("/").filter(e=>0<e.length);let l={capture_groups:[],handler:d};d="^\\/"+f.map(e=>"*"===e?"(?:[\\w\\.\\-%]+)":e.startsWith("$")?(l.capture_groups.push(e),"([\\w\\.\\-%]+)"):e).join("\\/")+"\\/?$";if(d in a.page_register)throw`Floofy Exception: location handler already exists on selector "${b}"`;a.page_register[d]=l;return!0}throw`Floofy Exception: location selector must be of type string, got ${typeof b}`;}throw`Floofy Exception: location handler must be of type function, got ${typeof d}`;
},get:(f,b)=>{if("string"===typeof b){for(let d in a.page_register){let l=b.match(new RegExp(d));if(l)return e=>{if(e&&"object"!==typeof e)throw`Floofy Exception: location state must be of type object, got ${typeof e}`;{let c={};for(let k=0;k<a.page_register[d].capture_groups.length;k++)c[a.page_register[d].capture_groups[k]]=l[k+1];let h;e={...null!=(h=history.state)?h:{},...null!=e?e:{},...c};location.pathname!==b&&history.pushState(e,document.title,b);a.page_register[d].handler(e)}}}return null}throw`Floofy Exception: URL selector must be of type string, got ${typeof b}`;
}})});addEventListener("DOMContentLoaded",()=>{let f=location.f[location.pathname];f&&f({});addEventListener("popstate",()=>{let b=location.f[location.pathname];b&&b({})})})})(floofy||(floofy={}));
