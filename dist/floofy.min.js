'use strict';function floofy(d,m=document){let l={},h=(floofy.selector_path in m?m[floofy.selector_path]+" ":"")+d;const q=a=>{let b=null;a=a.replace(/^[\w-_]+/,f=>{b=document.createElement(f);return""});b||(b=document.createElement("div"));a=a.replace(/\[[\w\-_]*(\s*=\s*)?([\w\-_]+|"((?!").)*"|'((?!').*)')\]/g,f=>{let [n,k]=f.replace(/(^\[|\]$)/g,"").split("=").map(g=>g.trim());k&&(k=k.replace(/(^"|"$)/g,"").replace(/(^'|'$)/g,""));b.setAttribute(n,k||"");return""});a=a.replace(/(?<=#)[\w-_]+/g,
f=>{b.id=f;return""});a=a.replace(/(?<=.)[\w-_]+/g,f=>{b.classList.add(f);return""});return b},e=(a,b)=>{let f=m;for(let n=0;n<a.length;n++){let k=a[n],g=f.querySelector(k);if(b&&n===a.length-1||!g)g=q(k),floofy.match_element(g),f.append(g);f=g}return f},c=a=>floofy.element_proxy(a,h);Object.defineProperty(l,"actual",{get:()=>floofy.element_proxy(e(d.split(/[\s>]/g).filter(a=>0<a.length),!1),h)});Object.defineProperty(l,"new",{get:()=>floofy.element_proxy(e(d.split(/[\s>]/g).filter(a=>0<a.length),
!0),h)});Object.defineProperty(l,"for",{get:()=>()=>{},set:a=>{if(h in floofy.element_register)throw`Floofy: illegal attempt to overwrite for handler on "${h}"`;floofy.element_register[h]={signature:Symbol("floofy-element"),selector_path:h,constructor:a};if("function"===typeof a)m.querySelectorAll(d).forEach(b=>{b instanceof HTMLElement&&a(floofy.element_proxy(b,h))});else throw new TypeError(`constructor must be of type function, received ${typeof a}`);}});Object.defineProperty(l,"all",{get:()=>
Array.from(m.querySelectorAll(d)).filter(a=>a instanceof HTMLElement).map(c)});Object.defineProperty(l,"first",{get:()=>floofy.element_proxy(m.querySelector(d),h)});return l}
(function(d){d.selector_path=Symbol("selector");d.direct_element=Symbol("element");d.element_register={};d.element_proxy=(e,c)=>e&&c?new Proxy(e,{getPrototypeOf(a){return Object.getPrototypeOf(a)},has(a,b){return b===d.selector_path||b===d.direct_element||"f"===b?!0:b in a},get(a,b){if(b===d.selector_path)return c;if(b===d.direct_element)return a;if("f"===b)return m(d.element_proxy(a,c));b=a[b];"function"===typeof b&&(b=Function.prototype.bind.call(b,a));return b},set(a,b,f){return a[b]=f},apply(a,
b){return Object.apply(a,b)},ownKeys(a){return Object.keys(a)}}):e;d.match_element=e=>{for(let c in d.element_register)d.element_register[c].signature in e||!e.matches(c)||(d.element_register[c].constructor(d.element_proxy(e,d.element_register[c].selector_path)),e[d.element_register[c].signature]="ready")};const m=e=>new Proxy(e,{get:(c,a)=>{if("string"===typeof a)return d(a,c);throw new TypeError("selector must be of type string");}});(new MutationObserver(e=>{for(let c of e)c.addedNodes.forEach(a=>
{a instanceof HTMLElement&&d.match_element(a)})})).observe(document,{childList:!0,subtree:!0});Object.defineProperty(String.prototype,"f",{get(){return d(this)}});Object.defineProperty(HTMLElement.prototype,"f",{get(){return m(this)}});let l={},h=[];const q=e=>{e=e.split("/").filter(c=>0<c.length);a:for(let c in l){let a=c.endsWith("!"),b=c.replace(/!$/,"").split("/").filter(p=>0<p.length),f=0,n=0,k=0,g=!1,t={};for(;f<b.length;){let p=e[k],r=b[f];switch(r){case p:g=!1;break;case "*":break;case "**":g=
!0;break;default:if(r.startsWith("$"))t[r]=f<e.length&&k<e.length?decodeURIComponent(p):"",g=!1;else if(!g)continue a}if(g){if(k===e.length-1)break}else f++;n++;k=Math.min(k+1,e.length-1)}if(!(a&&!g&&n<=e.length-1))return p=>{p=l[c]({...t,...history.state,...p});"function"===typeof p&&h.push(p)}}return()=>{}};Object.defineProperty(Location.prototype,"f",{get:function(){return new Proxy(this,{get:(e,c)=>{if("string"===typeof c)return a=>{history.pushState(a,document.title,c);q(c)(a||{})}},set:(e,c,
a)=>{if("string"===typeof c&&"function"===typeof a)return l[c]=a,!0}})}});document.addEventListener("DOMContentLoaded",()=>{q(location.pathname)({});addEventListener("popstate",()=>{0<h.length&&h.pop()({});q(location.pathname)({})})})})(floofy||(floofy={}));
