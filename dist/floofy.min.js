'use strict';function floofy(a,l){const c={};let d,k;d=floofy.element_register in a?a[floofy.element_register]:a[floofy.element_register]={};floofy.mutation_observer in a?k=a[floofy.mutation_observer]:(k=new MutationObserver(b=>{for(let h of b)k[floofy.mutation_update](Array.from(h.addedNodes).filter(g=>g instanceof HTMLElement))}),k.observe(a,{childList:!0,subtree:!0}),k[floofy.mutation_update]=b=>{let h=[];a:for(let g of b){for(let e in d)if(!(d[e].signature in g)&&g.matches(e)){g[d[e].signature]=
!0;d[e].constructor(g);h.push(!0);continue a}h.push(!1)}return h},a[floofy.mutation_observer]=k);const f=(b,h,g)=>{h=h.split(" ").map(n=>n.trim()).filter(n=>0<n.length);for(let n of h){if(h.indexOf(n)<h.length-1||g)if(b instanceof Element||b instanceof Document){var e=b.querySelector(n);if(e){b=e;continue}}e=n+"";let m;e=e.replace(/^[\w-_]+/,p=>{m=document.createElement(p);return""});m||(m=document.createElement("div"));e=e.replace(/\[[\w\-_]*(\s*=\s*)?([\w\-_]+|"((?!").)*"|'((?!').*)')\]/g,p=>{let [r,
q]=p.replace(/(^\[|\]$)/g,"").split("=").map(t=>t.trim());q&&(q=q.replace(/(^"|"$)/g,"").replace(/(^'|'$)/g,""));m.setAttribute(r,q||"");return""});e=e.replace(/#[\w-_]+/g,p=>{m.id=p.substr(1);return""});e=e.replace(/\.[\w-_]+/g,p=>{m.classList.add(p.substr(1));return""});b.appendChild(m);b=m}if(b instanceof HTMLElement){g=b;do if(g=g.parentElement||document,floofy.mutation_observer in g&&floofy.mutation_update in g[floofy.mutation_observer]&&g[floofy.mutation_observer][floofy.mutation_update]([b])[0])break;
while(!g.isSameNode(document))}return b instanceof HTMLElement?b:void 0};Object.defineProperty(c,"for",{get:()=>()=>{},set:b=>{if("function"===typeof b){if(l in d)throw`Floofy Exception: cannot reassign "for" handler on selector "${l}"`;d[l]={signature:Symbol(l),constructor:b};for(let h of c.all)b(h)}else throw`Floofy Exception: "for" constructor must by of type function, got ${typeof b}`;}});Object.defineProperty(c,"actual",{get:()=>f(a,l,!0)});Object.defineProperty(c,"new",{get:()=>f(a,l,!1)});
if(a instanceof Element||a instanceof Document)Object.defineProperty(c,"all",{get:()=>Array.from(a.querySelectorAll(l)).filter(b=>b instanceof HTMLElement)}),Object.defineProperty(c,"first",{get:()=>a.querySelector(l)});return c}
(function(a){a.element_register=Symbol("element_register");a.mutation_observer=Symbol("mutation_observer");a.mutation_update=Symbol("mutation_update");a.page_register={};Object.defineProperty(String.prototype,"f",{get(){return a(document,this)}});Object.defineProperty(Node.prototype,"f",{get(){return new Proxy({},{get:(l,c)=>{if("string"===typeof c)return a(this,c);throw`Floofy Exception: selectors must be of type string, got ${typeof c}`;}})}});Object.defineProperty(Location.prototype,"f",{get:()=>
new Proxy({},{set:(l,c,d)=>{if("function"===typeof d){if("string"===typeof c){l=c.split("/").filter(f=>0<f.length);let k={capture_groups:[],handler:d};d="^\\/"+l.map(f=>"*"===f?"(?:[\\w\\.\\-%~:/?#\\[\\]@!$&'\\(\\)*+,;]+)":f.startsWith("$")?(k.capture_groups.push(f),"([\\w\\.\\-%~:?#\\[\\]@!$&'\\(\\)*+,;]+)"):f).join("\\/")+"\\/?$";if(d in a.page_register)throw`Floofy Exception: location handler already exists on selector "${c}"`;a.page_register[d]=k;return!0}throw`Floofy Exception: location selector must be of type string, got ${typeof c}`;
}throw`Floofy Exception: location handler must be of type function, got ${typeof d}`;},get:(l,c)=>{if("string"===typeof c){for(let d in a.page_register){let k=c.match(new RegExp(d));if(k)return(f,b)=>{if(f&&"object"!==typeof f)throw`Floofy Exception: location state must be of type object, got ${typeof f}`;{let h={};for(let e=0;e<a.page_register[d].capture_groups.length;e++)h[a.page_register[d].capture_groups[e]]=decodeURIComponent(k[e+1]);let g;f={...null!=(g=history.state)?g:{},...null!=f?f:{},...h};
location.pathname!==c&&history.pushState(f,null!=b?b:document.title,c);a.page_register[d].handler(f)}}}return(d,k)=>{let f;d={...null!=(f=history.state)?f:{},...null!=d?d:{}};location.pathname!==c&&history.pushState(d,null!=k?k:document.title,c)}}throw`Floofy Exception: URL selector must be of type string, got ${typeof c}`;}})});addEventListener("DOMContentLoaded",()=>{location.f[location.pathname]();addEventListener("popstate",()=>{location.f[location.pathname]()})})})(floofy||(floofy={}));
